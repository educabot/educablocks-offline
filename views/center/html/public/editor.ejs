<!DOCTYPE html>
<html class="no-js css-menubar" lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
  <meta name="description" content="bootstrap admin template">
  <meta name="author" content="">
  <title>Educablocks</title>
  <link rel="apple-touch-icon" href="../../assets/images/apple-touch-icon.png">
  <link rel="shortcut icon" href="../../assets/images/favicon.png">
  <!-- Stylesheets -->
  <link rel="stylesheet" href="../../../global/css/bootstrap.min.css">
  <link rel="stylesheet" href="../../../global/css/bootstrap-extend.min.css">
  <link rel="stylesheet" href="../../assets/css/site.min.css">
  <link rel="stylesheet" href="../../assets/skins/blue.css">
  <link rel="stylesheet" href="../../assets/skins/blue.min.css">
  <link rel="stylesheet" href="../../../global/vendor/toastr/toastr.css">
  <link rel="stylesheet" href="../../../global/vendor/bootstrap-sweetalert/sweetalert.css">
  <!-- Plugins -->
  <link rel="stylesheet" href="../../../global/vendor/animsition/animsition.css">
  <link rel="stylesheet" href="../../../global/vendor/asscrollable/asScrollable.css">
  <link rel="stylesheet" href="../../../global/vendor/switchery/switchery.css">
  <link rel="stylesheet" href="../../../global/vendor/intro-js/introjs.css">
  <link rel="stylesheet" href="../../../global/vendor/slidepanel/slidePanel.css">
  <link rel="stylesheet" href="../../../global/vendor/flag-icon-css/flag-icon.css">
  <link rel="stylesheet" href="../../../global/vendor/waves/waves.css">
  <link rel="stylesheet" href="../../../global/vendor/chartist/chartist.css">
  <link rel="stylesheet" href="../../../global/vendor/jvectormap/jquery-jvectormap.css">
  <link rel="stylesheet" href="../../../global/vendor/webui-popover/webui-popover.css">
  <link rel="stylesheet" href="../../../global/vendor/toolbar/toolbar.css">
  <link rel="stylesheet" href="../../../global/vendor/bootstrap-select/bootstrap-select.css">

  <!-- Plugins For This Page -->
  <link rel="stylesheet" href="../../../global/vendor/webui-popover/webui-popover.min.css?v2.2.0">
  <link rel="stylesheet" href="../../../global/vendor/toolbar/toolbar.min.css?v2.2.0">

  <!-- Page -->
  <link rel="stylesheet" href="../../assets/examples/css/uikit/tooltip-popover.min.css?v2.2.0">
  <link rel="stylesheet" href="../../../global/vendor/chartist-plugin-tooltip/chartist-plugin-tooltip.css">
  <link rel="stylesheet" href="../../assets/examples/css/dashboard/v1.css">
  <!-- Fonts -->
  <link rel="stylesheet" href="../../../global/fonts/material-design/material-design.min.css">
  <link rel="stylesheet" href="../../../global/fonts/brand-icons/brand-icons.min.css">
  <link rel='stylesheet' href='http://fonts.googleapis.com/css?family=Roboto:300,400,500,300italic'>



  <!--[if lt IE 9]>
    <script src="../../global/vendor/html5shiv/html5shiv.min.js"></script>
    <![endif]-->
  <!--[if lt IE 10]>
    <script src="../../global/vendor/media-match/media.match.min.js"></script>
    <script src="../../global/vendor/respond/respond.min.js"></script>
    <![endif]-->
  <!-- Scripts -->
  <script src="../../..//global/js/arduino/socket.io.js"></script>
  <script src="../../..//global/js/arduino/client.js"></script>
  <script src="../../../global/vendor/breakpoints/breakpoints.js"></script>
  <script>
    Breakpoints();
  </script>
</head>

<body class="animsition">

  <!--[if lt IE 8]>
        <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
  <nav class="site-navbar navbar navbar-default navbar-fixed-top navbar-mega navbar-inverse" role="navigation">
    <div class="navbar-header">
      <button type="button" class="navbar-toggler hamburger hamburger-close navbar-toggler-left hided" data-toggle="menubar">
        <span class="sr-only">Toggle navigation</span>
        <span class="hamburger-bar"></span>
      </button>
      <button type="button" class="navbar-toggler collapsed" data-target="#site-navbar-collapse" data-toggle="collapse">
        <i class="icon md-more" aria-hidden="true"></i>
      </button>
      <div class="navbar-brand navbar-brand-center site-gridmenu-toggle" data-toggle="gridmenu">
        <img class="navbar-brand-logo" src="../../assets/images/logo.png" title="Educablocks">
        <span class="navbar-brand-text hidden-xs-down"> Educablocks</span>
      </div>
      <button type="button" class="navbar-toggler collapsed" data-target="#site-navbar-search" data-toggle="collapse">
        <span class="sr-only">Toggle Search</span>
        <i class="icon md-search" aria-hidden="true"></i>
      </button>
    </div>
    <div class="navbar-container container-fluid">
      <!-- Navbar Collapse -->
      <div class="collapse navbar-collapse navbar-collapse-toolbar" id="site-navbar-collapse">
        <!-- Navbar Toolbar -->
        <ul class="nav navbar-toolbar">

          <li class="nav-item dropdown">
            <a class="nav-link" data-toggle="dropdown" href="javascript:void(0)" data-animation="scale-up" aria-expanded="false" role="button">
              Código
            </a>
            <div class="dropdown-menu" role="menu">
              <a class="dropdown-item" href="./bloques.ejs" role="menuitem">
                <i class="icon md-puzzle-piece" aria-hidden="true"></i>
                Modo bloques</a>
              <div class="dropdown-divider" href="javascript:void(0)" role="menuitem">
              </div>
              <a class="dropdown-item" href="javascript:void(0)" role="menuitem" onclick="cargar_codigo()">
                <i class="icon md-code" aria-hidden="true"></i>
                Cargar código .ino</a>
              <a class="dropdown-item" href="javascript:void(0)" role="menuitem" onclick="exportar_codigo()">
                <i class="icon md-code" aria-hidden="true"></i>
                Guardar código .ino</a>
            </div>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link" data-toggle="dropdown" href="javascript:void(0)" data-animation="scale-up" aria-expanded="false" role="button">
              Ver
            </a>
            <div class="dropdown-menu" role="menu">
              <a class="dropdown-item" href="javascript:void(0)" role="menuitem">
                <i class="icon md-desktop-mac" aria-hidden="true"></i>
                Monitor serial</a>
            </div>
          </li>
        </ul>

        <div class="navbar-brand navbar-brand-center">
          <a href="../../../../home/theme/home.ejs">
            <img class="navbar-brand-logo" src="../../assets/images/logo.png" title="Educablocks">
          </a>
        </div>
      </div>

    </div>
  </nav>

  <div class="row" style="margin:5px;">
    <div class="col-xs-12 col-sm-6 col-md-8 perfil">
      <h4 class="example-title">
        <i class="icon md-layers"></i> Editor de código
      </h4>
    </div>

    <div class="col-xs-8 col-md-4" align="right" style="margin-top: 10px;">

      <button onclick="upload()" type="button" class="btn btn-danger">
        <i class="icon md-upload" aria-hidden="true"></i> Cargar</button> al puerto
      <select id="selPort" onChange="set_port()"></select>

      <button onclick="refresh_ports()" type="button" class="btn btn-icon btn-primary">
        <i class="icon md-refresh-alt" aria-hidden="true"></i>
      </button>

      <button onclick="open_monitor();" class="btn btn-icon btn-primary" data-toggle="modal" data-target="#monitorModal">
        <i class="icon md-search" aria-hidden="true"></i>
      </button>

    </div>
  </div>

    <!-- js -->
    <!-- Insert this line above script imports  -->
    <script>if (typeof module === 'object') { window.module = module; module = undefined; }</script>

    <script src="modules/jquery-3.1.1.js"></script>
    <script src="js/Blob.js"></script>
    <script src="js/spin.js"></script>
    <script src="js/FileSaver.min.js"></script>
    <script src="js/blockly_helper.js"></script>

    <script src="src/bloques/js/underscore/underscore.js"></script>
    <script src="src/bloques/js/blockly/blockly_compressedold.js"></script>
    <script src="src/bloques/js/blockly/blocks_compressedold.js"></script>
    <script src="src/bloques/js/blockly/arduino_compressed.js"></script>
    <script src="src/bloques/js/educablocks3.js"></script>
    <script src="src/highlight/highlight.pack.js"></script>

    <!-- Insert this line after script imports -->
    <script>if (window.module) module = window.module;</script>
  </div>
  <br>
<div class="page-main">
 <div class="page-content">


  <!-- Code editor -->
  <div class="form-group">
    <script src="../../../global/vendor/ace/ace.js"></script>
    <script src="../../../global/vendor/ace/ext-language_tools.js"></script>
    <textarea class="form-control" rows="20" id="code_editor">//recordá incluir tus librerías aquí

void setup() {
}

void loop() {

}
</textarea>

      </div>
    </div>
  <style type="text/css" media="screen">
    #code_editor {
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 100%;
    }
  </style>



  <script>
    ace.require("ace/ext/language_tools");
    var editor = ace.edit("code_editor");
    editor.session.setMode("ace/mode/c_cpp");
    editor.setShowPrintMargin(false);
    editor.setTheme("ace/theme/monokai");
    editor.setOptions({
      maxLines: 20,
      minLines: 20,
      fontSize: "10pt",
      enableBasicAutocompletion: true,
      enableSnippets: true,
      enableLiveAutocompletion: true,
    });
    editor.setValue(loadTempCode());
    editor.clearSelection();


    const {dialog} = require('electron').remote;

    function exportar_codigo() {
      dialog.showSaveDialog({ filters: [
        { name: 'código .ino', extensions: ['ino'] } ]}, function (fileName) {
          if (fileName === undefined) return;
          fs.writeFile(fileName, editor.getValue(), function (err) {
            console.log(err);
          });
      });
    }

    function cargar_codigo() {
      dialog.showOpenDialog({ filters: [
        { name: 'código .ino', extensions: ['ino'] },
        { name: 'todos los archivos', extensions: ['*'] }]}, function (fileNames) {
          if (fileNames === undefined) return;
          editor.setValue(fs.readFileSync(fileNames[0]).toString());
          editor.clearSelection();
      });
    }
</script>
  </div>
  <!-- End code editor -->

  <div class="form-group">
    <textarea class="form-control" rows="5" id="messages"></textarea>
  </div>
  <div class="modal fade" id="messagesModal" role="dialog">
    <div class="modal-dialog">
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>
        <div class="modal-body">
          <div id="image_modal" class="text-center">
            <img src="images/waiting.gif">
          </div>
          <div id="messages_modal" class="text-center"></div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
        </div>
      </div>
    </div>
  </div>
  <div class="modal fade" id="monitorModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Monitor Serie</h5>
          <button type="button" class="close" onclick="close_monitor();" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <textarea class="form-control" rows="5" id="monitor"></textarea>
          </div>
        </div>
      </div>
    </div>
  </div>

  </div>

  </br>



  <!-- End Site Action -->

  <!-- Footer -->

  <footer class="site-footer">
    <div class="site-footer-legal">© 2017
      <a href="../../../../home/theme/index.html">Educabot</a>
    </div>
    <div class="site-footer-right">
      Desarrollado
      <i class="red-600 icon md-favorite"></i> por
      <a href="../../../../home/theme/index.html">Educabot</a>
    </div>

  </footer>

  <!-- Core  -->
  <script src="../../../global/vendor/babel-external-helpers/babel-external-helpers.js"></script>
  <script src="../../../global/vendor/jquery/jquery.js"></script>
  <script src="../../../global/vendor/tether/tether.js"></script>
  <script src="../../../global/vendor/bootstrap/bootstrap.js"></script>
  <script src="../../../global/vendor/animsition/animsition.js"></script>
  <script src="../../../global/vendor/mousewheel/jquery.mousewheel.js"></script>
  <script src="../../../global/vendor/asscrollbar/jquery-asScrollbar.js"></script>
  <script src="../../../global/vendor/asscrollable/jquery-asScrollable.js"></script>
  <script src="../../../global/vendor/webui-popover/jquery.webui-popover.min.js"></script>
  <script src="../../../global/vendor/toolbar/jquery.toolbar.min.js"></script>
  <!-- Plugins
  <script src="../../../global/vendor/chartist/chartist.min.js"></script>
  <script src="../../../global/vendor/chartist-plugin-tooltip/chartist-plugin-tooltip.min.js"></script>
  <script src="../../../global/vendor/jvectormap/jquery-jvectormap.min.js"></script>
  <script src="../../../global/vendor/jvectormap/maps/jquery-jvectormap-world-mill-en.js"></script>
  <script src="../../../global/vendor/matchheight/jquery.matchHeight-min.js"></script>
  <script src="../../../global/vendor/peity/jquery.peity.min.js"></script>-->

  <!-- Plugins -->
  <script src="../../../global/vendor/switchery/switchery.min.js"></script>
  <script src="../../../global/vendor/intro-js/intro.js"></script>
  <script src="../../../global/vendor/screenfull/screenfull.js"></script>
  <script src="../../../global/vendor/slidepanel/jquery-slidePanel.js"></script>
  <script src="../../../global/vendor/webui-popover/jquery.webui-popover.min.js"></script>
  <script src="../../../global/vendor/toolbar/jquery.toolbar.js"></script>
  <script src="../../../global/vendor/bootstrap-select/bootstrap-select.js"></script>

  <!-- Scripts -->
  <script src="../../../global/js/State.js"></script>
  <script src="../../../global/js/Component.js"></script>
  <script src="../../../global/js/Plugin.js"></script>
  <script src="../../../global/js/Base.js"></script>
  <script src="../../../global/js/Config.js"></script>
  <script src="../../assets/js/Section/Menubar.js"></script>
  <script src="../../assets/js/Section/Sidebar.js"></script>
  <script src="../../assets/js/Section/PageAside.js"></script>
  <script src="../../assets/js/Plugin/menu.js"></script>


  <!-- Config -->
  <script src="../../../global/js/config/colors.js"></script>
  <script src="../../assets/js/config/tour.js"></script>
  <script>
    Config.set('assets', '../../assets');
  </script>
  <!-- Page -->
  <script src="../../assets/js/Site.js"></script>
  <script src="../../../global/js/Plugin/asscrollable.js"></script>
  <script src="../../../global/js/Plugin/slidepanel.js"></script>
  <script src="../../../global/js/Plugin/switchery.js"></script>
  <script src="../../../global/js/Plugin/webui-popover.js"></script>
  <script src="../../../global/js/Plugin/toolbar.js"></script>
  <script src="../../assets/examples/js/uikit/tooltip-popover.js"></script>
  <script src="../../../global/vendor/bootbox/bootbox.js"></script>
  <script src="../../../global/vendor/bootstrap-sweetalert/sweetalert.js"></script>
  <script src="../../../global/js/Plugin/bootstrap-select.js"></script>
  <script src="./js/clipboard.min.js"></script>

  <!-- 3. Instantiate clipboard -->
  <script>
    var clipboard = new Clipboard('.dropdown-item');

    clipboard.on('success', function (e) {
      console.log(e);
    });

    clipboard.on('error', function (e) {
      console.log(e);
    });

    var openFile = function (event) {
      var input = event.target;
      var reader = new FileReader();
      reader.onload = function () {
        var xml_text = reader.result;
        Blockly.mainWorkspace.clear();
        //$('#startBlocks').value = text;
        var vxml = Blockly.Xml.textToDom(xml_text);
        console.log(vxml);
        Blockly.Xml.domToWorkspace(Blockly.getMainWorkspace(), vxml);

        //resetWorkspace();

        //var node = document.getElementById('output');
        //node.innerText = text;
        //console.log(reader.result.substring(0, 200));
      };
      reader.readAsText(input.files[0]);
    };

    $(document).ready(function () {

      $("#perfilSelect").change(function () {
        document.location.href = $(this).val();
      });
    });

    const Store = require('electron').remote.require('electron-store');
    const store = new Store();
    store.set('perfil', 'bloquesAvanzado.ejs');

  </script>

  <!--  Notifications Plugin    -->
  <script src="../../../global/js/Plugin/bootbox.js"></script>
  <script src="../../../global/js/Plugin/bootstrap-sweetalert.js"></script>
  <script src="../../../global/js/Plugin/toastr.js"></script>
  <script src="../../assets/examples/js/advanced/bootbox-sweetalert.js"></script>
</body>

</html>